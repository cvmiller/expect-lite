#!/usr/bin/env expect-lite
# make this puppy run

; === set expect buffer big
!match_max -d 1000
@3
$dummy_var= this   is just to   show a var abcdefghijklmnopqrstuvwxyz
$joe=dude
$user=bob
*#LOGAPPEND
*TIMESTAMP

*NOINFO
*NODEBUG
#; === simple foreach
#[ $x=$dummy_var
#	>echo $x
#]
#*~fail.inc


~tcl_functions.inc

>echo "hello&$user&there"
>echo $user
<bob
>
?if $FAIL == 1? ;purple --- detected failure
>echo hello
>

#*INTERACT
>
*TERM


# fail script
#*~self_test_fail_script.txt

>echo "hello ken"\
<ken
>
>echo "$dummy_var"
+$var=\n(.+)
>
>echo "$dummy_var"
+$var=\n((\w+ )+)
>
; === look for longer text
$prompt=$ 
>cat /etc/passwd 
+$regList=\n((.|\n|\r)*)\$ 
>

; === look multiple captures
$prompt=$ 
>cat /etc/passwd 
+$var1=\n(www-data.*$)
+$var2=\n(avahi.*$)
>



*INTERACT
>


*TERM

$x=1 
$y=2 
; ==== $xABC$y 

*INTERACT

*PASS

~show_vars.inc zamaze=15 dummy_var=override_this joe=$user
>echo "hello"
<\nhello
>
*SHOW VARS
>
*PASS


#~/home/cvmiller/Expect-lite/junk
#~xyz.inc

$EL_jtag=	\
?if $EL_jtag == ? $jtag=192.168.1.100 :: $jtag=$EL_jtag

>ifconfig
# get IP address of loopback interface
<lo
+$ip_addr=inet addr:([0-9.]+)
+$ip_addr2=inet addr:(\d+)

; === test var
$blank=
#?if [ info exist $TEST ] ? ; === echo this :: ; === echo that
?if $TEST ==  ? ; === echo this :: ; === echo that
?if$TEST==? ; === echo this :: ; === echo that
?if $TEST ==$blank? ; === echo this :: ; === echo that
?if$JOE==$BLOW? ; === echo this :: ; === echo that
>
*SHOW VARS
$val=50
>
?if 40 < $val && $val < 60 ? ; it works :: ; NO GO
?if 40 < $val < 60 ? ; it works :: ; NO GO
>
$i=0
[ $i < 3
	>echo "hello ken"
	<ken
	$j=0
	[ $j < 2 
		>echo "bye now"
		>
		+$j
	]
	+$i
]
*INFINITE_LOOP 5
; == blank condition
[ < 3
>echo "blank"
]


>
*INTERACT

; show this \
>

# ; === Sudo stuff
# # set user defined prompt line
# */.+: $/
# 
# #*NOINFO
# >sudo cat /etc/resolv.conf
# +$challenge=[Pp](assword) for
# ?if $challenge == assword ? >>$EL_rootpass
# 
# >
# *INTERACT
# >
# 
# #!expect -re "assword" { send $EL_rootpass } timeout {puts "=====>Lost it"}
# #!stty -echo; send  $EL_rootpass ; stty echo
